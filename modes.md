# Режимы

В предыдущей главе мы впервые столкнулись с режимами. Теперь давайте рассмотрим эту концепцию дальше относительно типов доступных режимов и того, что мы можем сделать в каждом из них.

## Типы режимов

В Vim есть три основных режима:

1. Нормальный режим, где вы можете запускать команды. Это режим по умолчанию, в котором запускается Vim.
2. Режим вставки - в котором вы вставляете, т.е. пишете текст.
3. Визуальный режим - это когда вы визуально выделяете кучу текста, чтобы запустить команду/операцию только над этой частью текста.

## Нормальный режим

По умолчанию вы находитесь в обычном режиме. Давайте посмотрим, что мы можем сделать в этом режиме.

Введите `:echo "hello world"` и нажмите Enter. Вы должны увидеть знаменитые слова hello world эхом возвращенные к вам. То, что вы только что сделали, это запустили команду Vim под названием `:echo`, и вы предоставили ей текст, который был незамедлительно напечатан.

Введите `/ hello` и нажмите Enter. Vim будет искать эту фразу и перейдет к первому вхождению.

Это были всего лишь два простых примера команд, доступных в обычном режиме. В последующих главах мы увидим еще много таких команд.

## Как пользоваться справкой

Почти так же важно, как знать нормальный режим, знать как использовать команду `:help`. Здесь вы узнаете больше о командах, доступных в Vim.

Помните, что вам не нужно знать все команды, доступные в Vim, гораздо лучше знать где их найти когда они понадобятся. Например, в разделе `:help usr_toc` мы переходим к оглавлению справочного руководства. Вы можете посмотреть `:help index` для поиска конкретной темы, которая вас интересует, например, запустите `/insert mode`, чтобы увидеть соответствующую информацию о режиме вставки.

Если вы не можете вспомнить эти две темы справки, просто нажмите `F1` или запустите `:help`.

## Режим вставки

Когда Vim запускается в нормальном режиме, мы видели, как использовать i для перехода в режим вставки. Есть и другие способы переключения из нормального режима в режим вставки:

1. Запустите `:e dapping.txt`
2. Нажмите `i`
3. Введите следующий абзац (включая все опечатки и ошибки, мы исправим их позже):

    > means being determined about being determined and being passionate about being passionate

4. Нажать клавишу `<Esc>` для переключения в нормальный режим.
5. Запустите `:w`

Упс, мы, кажется, пропустили слово в начале строки, а курсор находится в конце строки, что нам теперь делать?

Каков был бы наиболее эффективный способ перейти к началу строки и вставить пропущенное слово? Должны ли мы использовать мышь, чтобы переместить курсор в начало строки? Должны ли мы использовать клавиши со стрелками, чтобы пройти весь путь до начала линии. Должны ли мы нажать клавишу home, а затем i, чтобы снова переключиться в режим вставки?

Оказывается, что наиболее эффективным способом будет нажать `I` (прописная буква I):

1. Нажмите `I`
2. Введите `Dappin`
3. Нажмите клавишу `<Esc>` для перключения обратно в нормальный режим.

Обратите внимание, что мы использовали другой ключ для переключения в режим вставки, его особенность заключается в том, что он перемещает курсор в начало строки, а затем переключается в режим вставки.

Также обратите внимание, как важно *переключиться обратно в нормальный режим, как только вы закончите вводить текст*. Выработка этой привычки будет полезна, потому что большая часть вашей работы (после написания начальной фазы) будет в нормальном режиме - вот где происходит все самое важное переписывание/редактирование/полировка.

Теперь давайте возьмем другой вариант команды `i`. Обратите внимание, что нажатие кнопки `i` помещает курсор перед текущей позицией, а затем переключается в режим вставки. Чтобы поместить курсор после текущей позиции, нажмите клавишу `a`

1. Нажмите `a`
2. Введите `g` (чтобы завершить слово как "Dapping")
3. Нажмите `<Esc>` чтобы вернуться в нормальный режим

Аналогично связи между клавишами `i` и `I`, существует связь между клавишами `a` и `A`- если вы хотите добавить текст в конце строки, нажмите `A`.

1. Нажмите `A`
2. Введите `.` (поставье точку чтобы правильно завершить предложение)
3. Нажмите `<Esc>` для возврата в нормальный режим

Подведем итог четырем ключам, которые мы узнали ранее:

| Команда | Действие                                      |
| ---     | ---                                           |
| `i`     | вставить текст непосредственно перед курсором |
| `I`     | вставить текст в начале строки                |
| `a`     | добавить текст сразу после курсора            |
| `A`     | добавить текст в конце строки                 |

Обратите внимание, что команды верхнего регистра являются "большими" версиями команд нижнего регистра.

Теперь, когда мы научились быстро перемещаться по текущей строке, давайте посмотрим, как перейти к новым строкам. Если вы хотите 'о'ткрыть новую строку, чтобы начать писать, нажмите клавишу `o`.
Now that we are proficient in quickly moving in the current line, let's see how to move to new lines. If you want to 'o'pen a new line to start writing, press the `o` key.

1. Нажмите `o`
2. Введите `I'm a rapper`.
3. Нажмите `<Esc>` для возврата в нормальный режим.

Хм, было бы более привлекательным, если бы это новое предложение, которое мы написали, было в абзаце само по себе.

1. Нажмите `O` (прописную 'O')
2. Нажмите `<Esc>` для возврата в нормальный режим.

Подведем итог двум новым ключам, которые мы только что узнали:

| Команда | Действие                   |
| ---     | ---                        |
| `o`     | откройте новую строку ниже |
| `O`     | открыть новую строку выше  |

Обратите внимание, что верхний и нижний регистр команд 'o' противоположны в направлении, в котором они открывают строку.

Было ли что-то не так в тексте, который мы только что написали? Ааа, это должен быть "dapper", а не "rapper"! Это один символ, который мы должны изменить, каков наиболее эффективный способ сделать это?

Мы могли бы нажать `i`, чтобы переключиться в режим вставки, затем клавишу `<Del>`", чтобы удалить `r` и ввести `d`, а затем нажать `<Esc>`, чтобы вернуться из режима вставки. Но это четыре шага для такого простого изменения! Есть ли что-то лучше? Вы можете использовать `s` клавиша - s 's'ubstiyute, т.е. замены.

1. Переместите курсор на символ `r` (или просто нажмите `b` для перемещения 'b'ack (назад) на начало слова)
2. Нажмите `s`
3. Введите `d`
4. Нажмите `<Esc>` для возврата в нормальный режим

Ну, хорошо, возможно это не спасло нас сейчас, но представьте себе повторение такого процесса многократно в течение дня! Выполнение такой мирской операции как можно быстрее полезно, потому что помогает нам сосредоточить нашу энергию на более творческих и интересных аспектах. Как говорит Линус Торвальдс: *"это не просто делает вещи быстрее, а потому, что это так быстро, способ вашей работы резко меняется."*

Опять же, есть большая версия клавиши `s` - `S`, которая заменяет всю строку вместо текущего символа.

1. Нажмите `S`
2. Введите `Be a sinner`.
3. Нажмите `<Esc>` для возврата в нормальный режим.

| Команда | Действие                |
| ---     | ---                     |
| `s`     | заменить текущий символ |
| `S`     | заменить текущую строку |

Давайте вернемся к нашему последнему действию... Не можем ли мы сделать его более эффективным, так как мы хотим 'r'eplace (заменить) только один символ? Да, мы можем использовать клавишу `R`.

1. Переместите курсор на первый символ слова `sinner`.
2. Нажмите `r`
3. Введите `d`

Обратите внимание, что мы уже вернулись в нормальный режим и не нужно нажимать `<Esc>`.

Существует более крупная версия `r` под названием `R`, которая заменит непрерывные символы.

1. Переместите курсор на 'i' в слове sinner.
2. Нажмите `R`
3. Введите `app` (слово теперь становится 'dapper')
4. Нажмите `<Esc>` для возврата в нормальный режим.

| Команда | Действие |
| ---     | ---                     |
| `r`     | заменяет текущий символ |
| `R`     | заменяет последовательность символов |

Теперь текст должен выглядеть так:

> Dapping means being determined about being determined and being passionate about being passionate.
> <br>
> Be a dapper.

Фух. Мы многое рассмотрели в этой главе, но я гарантирую, что это единственный шаг, который является самым трудным. Как только вы усвоите это, вы в значительной степени познаете сердце и душу того, как работает Vim, и все другие функции в Vim - это просто глазурь на торте.

Повторим: понимание того, как работают режимы и переключение между режимами является ключом к становлению Виммера, так что если вы еще не переварили приведенные выше примеры, пожалуйста, не стесняйтесь перечитать их снова. Потратьте столько времени, сколько вам необходимо.

Если вы хотите прочитать более подробные сведения об этих командах, см. `:help inserting` и `:help replacing`.

## Визуальный режим

Предположим, Вы хотите выбрать несколько слов и полностью заменить их каким-то новым текстом, который напишите. Что Вы сделаете?

Одним из способов было бы использовать мышь, чтобы щелкнуть в начале текста, который вас интересует, удерживая левую кнопку мыши перетащить мышь до конца соответствующего текста, а затем отпустить левую кнопку мыши. Это кажется ужасным отвлечением.

Мы могли бы использовать клавиши `<Del>` или `<Backspace>` для удаления всех символов, но это кажется еще хуже по эффективности.

Наиболее эффективным способом было бы поместить курсор в начало текста, нажать `v` для запуска визуального режима и использовать клавиши со стрелками или любые команды перемещения текста для перехода в конец соответствующего текста (например, нажмите `5e` для перемещения в конец 5-го слова, отсчитанного от текущей позиции курсора), а затем нажмите `c`, чтобы 'c'hange (изменить) текст. Обратите внимание на повышение эффективности.

В этой конкретной операции (команда `c`) вы будете переведены в режим вставки после ее завершения, поэтому нажмите `<Esc>`, чтобы вернуться в нормальный режим.

Команда `v` работает с символами. Если вы хотите работать со строками, используйте верхний регистр `V`.

## Резюме

Вот рисунок взаимосвязи между различными режимами:

```
+---------+  i,I,a,A,o,O,r,R,s,S  +----------+
| Нормал  +---------->------------+ Режим    |
| режим   |                       | вставки  |
|         +----------<------------+          |
+-+---+---+        <Esc>          +----------+
   |  |
   |  |
   |  |
   |  |
v, |  |
V  V  ^ <Esc>
   |  |
   |  |
   |  |
   |  |
+---+---+----+
| Визуальный |
| режим      |
+------------+
```

> ПРИМЕЧАНИЕ: этот рисунок был создан с помощью Vim и [плагина DrawIt Dr.Chip'а](http://www.vim.org/scripts/script.php?script_id=40).

Смотрите `:help vim-modes-intro` и `:help mode-switching` для получения подробной информации о различных режимах и способах переключения между ними соответственно.

Если вы по-прежнему не уверены в том, что концепция режимов занимает центральное место в силе и простоте Vim, прочитайте статьи на ["Почему Vi"] (http://www.viemu.com/a-why-vi-vim.html) и [модель ввода vi](http://blog.ngedit.com/2005/06/03/the-vi-input-model/) о том, почему это лучший способ редактирования.
